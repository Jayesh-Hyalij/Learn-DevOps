## üê≥ What is a Docker Registry/Repository?
- A Docker Registry is a storage and distribution system for Docker images.
- A Repository is a collection of Docker images with the same name but different tags (versions).
- Example:
    - nginx:1.21, nginx:latest ‚Äì both are in the nginx repository.
    - Docker Hub is the default public registry.

## 1. üîì Insecure Docker Registry
### üîç What is it?
- A Docker Registry running without TLS (HTTPS).
- Uses HTTP instead of encrypted HTTPS for image push/pull operations.

### ‚ùì Why use it?
- For internal or development/test environments where:
    - Security is not a concern.
    - Faster setup without needing certificates.

### üìå Use Case
- Lab testing, dev environments, CI/CD pipelines in isolated private networks.

### üõ†Ô∏è How to configure it?
***1. Start registry:***
```
bash
docker run -d -p 5000:5000 --name registry registry:2
```
***2. Allow insecure registry in Docker daemon:***

**Edit /etc/docker/daemon.json:**
```
json
{
  "insecure-registries": ["localhost:5000"]
}
```
***3. Restart Docker:***
```
bash
systemctl restart docker
```
### ‚ö†Ô∏è Risks
- No encryption ‚Üí data/image + credentials (if any) are exposed.
- Never use in production!

## 2. Secure Docker Registry
### üîç What is it?
- A Docker Registry served over HTTPS (TLS/SSL).
- Uses a valid certificate (self-signed or CA-signed).

### ‚ùì Why use it?
- Encrypts image transfers (push/pull).
- Required for production-grade deployments.
- Prevents MITM attacks, data interception.

### üìå Use Case
- Enterprises, cloud-native apps, Kubernetes clusters, CI/CD workflows.

### üõ†Ô∏è How to configure?
***1. Generate certs (self-signed for test):***
```
bash
openssl req -newkey rsa:4096 -nodes -sha256 -keyout domain.key -x509 -days 365 -out domain.crt
```
***2. Run registry with TLS:***
```
bash
docker run -d \
  -p 5000:5000 \
  --name registry \
  -v $(pwd)/certs:/certs \
  -e REGISTRY_HTTP_TLS_CERTIFICATE=/certs/domain.crt \
  -e REGISTRY_HTTP_TLS_KEY=/certs/domain.key \
  registry:2
```
## ‚úÖ Benefits
- Secure by encryption.
- Can be integrated with Kubernetes, Docker Swarm, Harbor, etc.

## 3. üîë Docker Registry With Basic Authentication
### üîç What is it?
- A secure registry with user authentication (username/password).
- Adds an extra layer of access control on top of HTTPS.

### ‚ùì Why use it?
- Restrict access to private images.
- Enforce identity for image publishers/pullers.
- Prevent unauthorized access to sensitive containers.

### üìå Use Case
- Teams, organizations, private DevOps pipelines.
- Hosting custom app images (e.g., myorg/app-backend:v1).

### üõ†Ô∏è How to configure?
**Step 1: Create credentials file (htpasswd)**
```
bash
mkdir auth
docker run --entrypoint htpasswd httpd:2 -Bbn myuser mypass > auth/htpasswd
```
**Step 2: Run secure registry with auth**
```
bash
docker run -d \
  -p 5000:5000 \
  --name secure-registry \
  -v $(pwd)/certs:/certs \
  -v $(pwd)/auth:/auth \
  -e REGISTRY_HTTP_TLS_CERTIFICATE=/certs/domain.crt \
  -e REGISTRY_HTTP_TLS_KEY=/certs/domain.key \
  -e REGISTRY_AUTH=htpasswd \
  -e REGISTRY_AUTH_HTPASSWD_REALM="Registry Realm" \
  -e REGISTRY_AUTH_HTPASSWD_PATH=/auth/htpasswd \
  registry:2
```
**Step 3: Login from Docker client**
```
bash
docker login myregistry.com:5000
Username: myuser
Password: ****
```
**Step 4: Push an image**
```
bash
docker tag myimage myregistry.com:5000/myimage
docker push myregistry.com:5000/myimage
```
## ‚úÖ Benefits
- Ensures only authorized users can access or push images.
- Required for multi-user environments or CI/CD security policies.

## üîÑ Summary Comparison
| Feature             | Insecure Registry | Secure Registry | Secure Registry with Auth |
| ------------------- | ----------------- | --------------- | ------------------------- |
| HTTPS Support       | ‚ùå                 | ‚úÖ               | ‚úÖ                         |
| Encryption          | ‚ùå                 | ‚úÖ               | ‚úÖ                         |
| User Authentication | ‚ùå                 | ‚ùå               | ‚úÖ                         |
| Use in Production   | ‚ùå                 | ‚úÖ               | ‚úÖ                         |
| Setup Complexity    | Low               | Medium          | High                      |

